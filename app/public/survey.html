<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Survey</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <h1>Survey Questions</h1>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <form>
                    <div class="form-group">
                        <h2>About You</h2>
                        <label for="nameInput">Name (Required)</label>
                        <input type="text" class="form-control" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="imageLink">Link to Photo Image (Required)</label>
                        <input type="text" class="form-control" id="photo" required>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <form>
                    <div class="form-group">
                        <h2>Question 1</h2>
                        <label for="inputState">It's okay to tell white lies.</label>
                        <br>
                        <select data-placeholder="" id="q1" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 2</h2>
                        <label for="inputState">Family should be the most important thing in life.</label>
                        <br>
                        <select data-placeholder="" id="q2" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 3</h2>
                        <label for="inputState">Money is the root of all evil.</label>
                        <br>
                        <select data-placeholder="" id="q3" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 4</h2>
                        <label for="inputState">I can agree with those with different political views.</label>
                        <br>
                        <select data-placeholder="" id="q4" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 5</h2>
                        <label for="inputState">It's important to stay physically active</label>
                        <br>
                        <select data-placeholder="" id="q5" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 6</h2>
                        <label for="inputState">I would rather stay in and watch Netflix then go out.</label>
                        <br>
                        <select data-placeholder="" id="q6" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 7</h2>
                        <label for="inputState">It's important to disconnect from electronics and enjoy nature.</label>
                        <br>
                        <select data-placeholder="" id="q7" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 8</h2>
                        <label for="inputState">I believe that eathing meat is unethical.</label>
                        <br>
                        <select data-placeholder="" id="q8" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 9</h2>
                        <label for="inputState">It's okay to sometimes break your promises.</label>
                        <br>
                        <select data-placeholder="" id="q9" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <h2 class="mt-4">Question 10</h2>
                        <label for="inputState">The Red Hot Chili Peppers are the best band of all-time.</label>
                        <br>
                        <select data-placeholder="" id="q10" class="chosen-select">
                            <option selected value="">Select an Option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                </form> 
                <button type="submit" class="btn btn-primary mb-4" id="submit">Submit</button>
            </div>            
        </div>
    </div>
    <!--Modal-->
    <div id="results-modal" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title"><strong>Best Match</strong></h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h2 id="match-name"></h2>
                    <img id="match-img" src="" alt="match-img">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script type="text/javascript">
        $("#submit").on("click", function() {
            event.preventDefault();

            function validateForm() {
                var isValid = true;
                $(".form-control").each(function() {
                    if ($(this).val() === "") {
                        isValid = false;
                    }
                });
                $(".chosen-select").each(function() {
                    if ($(this).val() === "") {
                        isValid = false;
                    }    
                });
                return isValid;
            }
        if (validateForm()) {
            var userData = {
                name: $("#name").val(),
                photo: $("#photo").val(),
                scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val(), ]
                };

            $.ajax({
                    method: "POST", 
                    url: "/api/friends",
                    headers: {
                        "Accept": "application/json",
                        "Content-Type": "application/json"
                    },
                    data: JSON.stringify(userData)
                }).then(data=>{
                    console.log(data);
                    $("#match-name").text(data.name);
                    $("#match-img").attr("src",data.photo);
                    $("#results-modal").modal("toggle");
                });
            }
            else {
                alert("please fill out all fields");
            }    
    });
    </script>
</body>
</html>